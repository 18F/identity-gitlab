apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: tshnode-network-policy
  namespace: teleport
spec:
  podSelector:
    matchLabels:
      k8s-app: tshnode
  policyTypes:
  - Egress
  egress:
  - to:
    - podSelector:
        matchLabels:
          app: gitlab-shell
    ports:
    - protocol: TCP
      port: 22
  - to:
    - podSelector:
        matchLabels:
          app: teleport-cluster
    ports:
    - protocol: TCP
      port: 3023
    - protocol: TCP
      port: 3024
    - protocol: TCP
      port: 3080
    - protocol: TCP
      port: 443
